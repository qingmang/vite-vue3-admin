var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,i=(t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r;import{D as s}from"./dynamic-table.e550ac7f.js";import{y as o,J as c,K as d}from"./index.d17e73d8.js";import{an as u,o as b,bY as f,d as p,r as m,b as y,A as h,Q as v,y as g,by as O,h as j,F as x}from"./vendor.c17881da.js";function I(){return o({url:c.list,method:"get"})}var w,k=p((w=((e,t)=>{for(var a in t||(t={}))n.call(t,a)&&i(e,a,t[a]);if(r)for(var a of r(t))l.call(t,a)&&i(e,a,t[a]);return e})({},{name:"SystemMonitorOnline"}),t(w,a({setup(e){const t=m();((e={})=>{const t=d().client,a=new Map,r=()=>{Object.keys(e).forEach((r=>{if(t){const n=e[r];a.set(r,n),t.subscribe(r,n)}}))};u((()=>t),r),b(r),f((()=>{Object.keys(e).forEach((e=>{t&&a.has(e)&&t.unsubscribe(e,a.get(e))}))}))})({connect(){var e;null==(e=t.value)||e.refreshTable()},online(){var e;null==(e=t.value)||e.refreshTable()},offline(){var e;null==(e=t.value)||e.refreshTable()}});const a=[{title:"#",dataIndex:"id",width:80,align:"center",hideInSearch:!0},{title:"用户名",dataIndex:"username",align:"center",bodyCell:({record:e})=>g(x,null,[g("span",{class:"pr-16px"},[e.username]),e.isCurrent&&g(O,{color:"red"},{default:()=>[j("当前")]})])},{title:"登录IP",dataIndex:"ip",width:140,align:"center"},{title:"登录时间",dataIndex:"time",align:"center"},{title:"操作系统",dataIndex:"os",align:"center"},{title:"浏览器",dataIndex:"browser",align:"center"},{title:"操作",dataIndex:"$action",align:"center",actions:({record:e})=>[{label:"下线",auth:"sys.online.kick",disabled:e.disable,popConfirm:{title:"确定下线该用户吗?",onConfirm:()=>r(e)}}]}],r=async e=>{var t;await(t={id:e.id},o({url:c.kick,method:"post",data:t}))};return(e,r)=>(y(),h(v(s),{ref_key:"dynamicTableRef",ref:t,"header-title":"在线用户","title-tooltip":"这是真实操作，请不要随意将其他用户踢下线。","data-request":v(I),columns:a},null,8,["data-request"]))}}))));export{k as default};
